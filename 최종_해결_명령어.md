# ğŸš¨ ìµœì¢… í•´ê²° ëª…ë ¹ì–´ - CSP ì™„ì „ ìš°íšŒ

## ğŸ“‹ **í˜„ì¬ ìƒí™©**
- ë°°í¬ëœ ì›¹ ì•±ì—ì„œ ì—¬ì „íˆ `blob:` URLì´ ì°¨ë‹¨ë¨
- CSP ì—ëŸ¬: `img-src 'self' data: https:` (blob: ëˆ„ë½)
- **ê°•ë ¥í•œ CSP ìš°íšŒ ë°©ë²• ì ìš© í•„ìš”**

## ğŸš€ **ì¦‰ì‹œ ì‹¤í–‰í•  ëª…ë ¹ì–´ë“¤**

### 1. **ë°°í¬ ì„œë²„ì— ì ‘ì†**
```bash
# ë°°í¬ ì„œë²„ (210.117.181.115)ì— SSH ì ‘ì†
ssh user@210.117.181.115
```

### 2. **ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì™„ì „ ì¤‘ì§€**
```bash
# ëª¨ë“  ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker-compose down
docker system prune -f

# ë˜ëŠ” ê°œë³„ ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker stop heritage-web heritage-api
docker rm heritage-web heritage-api
```

### 3. **ìƒˆë¡œìš´ íŒŒì¼ë“¤ ì—…ë¡œë“œ ë° ì ìš©**
```bash
# final_csp_fix.tar.gz íŒŒì¼ì„ ì„œë²„ì— ì—…ë¡œë“œí•œ í›„:
tar -xzf final_csp_fix.tar.gz

# ì›¹ ì•± íŒŒì¼ ë³µì‚¬ (ê¸°ì¡´ íŒŒì¼ ë®ì–´ì“°ê¸°)
cp -r my_cross_app/build/web/* /path/to/your/web/directory/

# Nginx ì„¤ì • ê°•ì œ ì ìš©
cp nginx.conf /etc/nginx/conf.d/default.conf
nginx -t
systemctl restart nginx
```

### 4. **Docker ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘**
```bash
# ì „ì²´ ì¬ì‹œì‘
docker-compose up -d

# ë˜ëŠ” ê°œë³„ ì¬ì‹œì‘
docker-compose build --no-cache heritage-web
docker-compose up -d heritage-web
```

### 5. **ì¦‰ì‹œ í…ŒìŠ¤íŠ¸**
```bash
# ì›¹ ì•± ì ‘ì† í›„ ê°•ì œ ìƒˆë¡œê³ ì¹¨
# http://210.117.181.115:3001/#/home
# Ctrl+Shift+R (ìºì‹œ ì™„ì „ ì‚­ì œ)
```

## ğŸ”§ **ê°•ë ¥í•œ CSP ìš°íšŒ ì„¤ì •**

### A. Nginx ì„¤ì • (ì™„ì „ ìš°íšŒ)
```nginx
add_header Content-Security-Policy "
    default-src *;
    img-src * data: blob:;
    media-src * data: blob:;
    connect-src *;
    script-src * 'unsafe-inline' 'unsafe-eval';
    style-src * 'unsafe-inline';
    font-src * data:;
    frame-ancestors *;
" always;
```

### B. Flutter ì›¹ ì•± index.html (ì™„ì „ ìš°íšŒ)
```html
<meta http-equiv="Content-Security-Policy" content="default-src *; img-src * data: blob:; media-src * data: blob:; connect-src *; script-src * 'unsafe-inline' 'unsafe-eval'; style-src * 'unsafe-inline'; font-src * data:; frame-ancestors *;">
```

## ğŸ¯ **ì„±ê³µ í™•ì¸ ë°©ë²•**

### 1. **ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬**
- F12 â†’ Console íƒ­
- CSP ì—ëŸ¬ê°€ ì™„ì „íˆ ì‚¬ë¼ì¡ŒëŠ”ì§€ í™•ì¸
- `blob:` URLì´ `(blocked:csp)` ì—†ì´ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸

### 2. **Network íƒ­ í™•ì¸**
- `blob:` ìš”ì²­ì´ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸
- Statusê°€ `200` ë˜ëŠ” ì •ìƒ ìƒíƒœì¸ì§€ í™•ì¸

### 3. **ì´ë¯¸ì§€ í‘œì‹œ í™•ì¸**
- ë¬¸í™”ìœ ì‚° ì‚¬ì§„ì´ ê¹¨ì§„ ì•„ì´ì½˜ ëŒ€ì‹  ì‹¤ì œ ì‚¬ì§„ì´ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

## ğŸš¨ **ì—¬ì „íˆ ë¬¸ì œê°€ ìˆë‹¤ë©´**

### 1. **CSP ì™„ì „ ë¹„í™œì„±í™” (ìµœí›„ì˜ ìˆ˜ë‹¨)**
```nginx
# nginx.confì—ì„œ CSP í—¤ë” ì™„ì „ ì œê±°
# add_header Content-Security-Policy ... ì¤„ì„ ì£¼ì„ ì²˜ë¦¬
```

### 2. **ë¸Œë¼ìš°ì € ìºì‹œ ì™„ì „ ì‚­ì œ**
```bash
# ë¸Œë¼ìš°ì €ì—ì„œ:
# 1. Ctrl+Shift+Delete
# 2. "ëª¨ë“  ì‹œê°„" ì„ íƒ
# 3. ëª¨ë“  í•­ëª© ì²´í¬
# 4. ì‚­ì œ í›„ ì¬ì ‘ì†
```

### 3. **ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œ í…ŒìŠ¤íŠ¸**
```bash
# ë¸Œë¼ìš°ì € ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œ í…ŒìŠ¤íŠ¸
# http://210.117.181.115:3001/#/home
```

## ğŸ“ **ë°°í¬ íŒŒì¼ ëª©ë¡**

- âœ… `final_csp_fix.tar.gz` - ì™„ì „ ìš°íšŒëœ ì›¹ ì•± + Nginx ì„¤ì •
- âœ… `my_cross_app/build/web/index.html` - ì™„ì „ ìš°íšŒëœ CSP ì„¤ì •
- âœ… `nginx.conf` - ì™„ì „ ìš°íšŒëœ CSP í—¤ë” ì„¤ì •
- âœ… `docker-compose.yml` - ì»¨í…Œì´ë„ˆ ì„¤ì •

## âš¡ **ì¦‰ì‹œ ì‹¤í–‰ ìˆœì„œ**

1. **ì„œë²„ ì ‘ì†** â†’ `ssh user@210.117.181.115`
2. **ì»¨í…Œì´ë„ˆ ì™„ì „ ì¤‘ì§€** â†’ `docker-compose down && docker system prune -f`
3. **íŒŒì¼ ì—…ë¡œë“œ** â†’ `final_csp_fix.tar.gz` ì—…ë¡œë“œ ë° ì••ì¶• í•´ì œ
4. **ì„¤ì • ê°•ì œ ì ìš©** â†’ Nginx ì„¤ì • ë³µì‚¬ ë° ì¬ì‹œì‘
5. **ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘** â†’ `docker-compose up -d`
6. **í…ŒìŠ¤íŠ¸** â†’ ë¸Œë¼ìš°ì €ì—ì„œ `Ctrl+Shift+R` í›„ ì´ë¯¸ì§€ í™•ì¸

## ğŸ‰ **ì˜ˆìƒ ê²°ê³¼**

- âœ… CSP ì—ëŸ¬ê°€ ì™„ì „íˆ ì‚¬ë¼ì§
- âœ… `blob:` URLì´ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë¨
- âœ… ì´ë¯¸ì§€ê°€ ê¹¨ì§„ ì•„ì´ì½˜ ëŒ€ì‹  ì‹¤ì œ ì‚¬ì§„ì´ í‘œì‹œë¨
- âœ… ëª¨ë“  ì´ë¯¸ì§€ ì†ŒìŠ¤ê°€ ì •ìƒ ì‘ë™

ì´ì œ `blob:` URLì´ ì™„ì „íˆ í—ˆìš©ë˜ì–´ ì´ë¯¸ì§€ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë  ê²ƒì…ë‹ˆë‹¤! ğŸš€
